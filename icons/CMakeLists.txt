#
# material-design-icons library
#

SET(ICONS
	action-aspect-ratio
	action-preview
	action-today
	content-add
	content-clear
	content-content-copy
	content-link
	content-link-off
	content-remove
	image-image
	image-picture-as-pdf	
	navigation-more-horiz
	navigation-south
)

SET(RESOURCE_FILE ${CMAKE_CURRENT_BINARY_DIR}/material-design-icons.rc)
FILE(WRITE ${RESOURCE_FILE} [=[
/*
 * This file is automatically generated by CMake
 * Please DO NOT EDIT
 */

#include <windows.h>
LANGUAGE LANG_NEUTRAL, SUBLANG_DEFAULT

// icons
]=])

UNSET(ICO_FILES)
FOREACH(ICO IN LISTS ICONS)
	LIST(APPEND ICO_FILES ico/${ICO}.ico)
	SET(ICO_RES "${ICO} ICON \"${CMAKE_CURRENT_SOURCE_DIR}/ico/${ICO}.ico\"")
	FILE(APPEND ${RESOURCE_FILE} "${ICO_RES}\n")
ENDFOREACH()

SET(SRC_FILES ${RESOURCE_FILE})
IF(MINGW)
	LIST(APPEND SRC_FILES material-design-icons.c)
ENDIF()

ADD_LIBRARY(material-design-icons SHARED ${SRC_FILES} ${ICO_FILES})

SET_SOURCE_FILES_PROPERTIES(${ICO_FILES} PROPERTIES HEADER_FILE_ONLY ON)
SET_SOURCE_FILES_PROPERTIES(${RESOURCE_FILE} PROPERTIES GENERATED ON)

SOURCE_GROUP("Icon files" FILES ${ICO_FILES})
SOURCE_GROUP("Generated files" FILES ${RESOURCE_FILE})

IF(MSVC)
	TARGET_LINK_OPTIONS(material-design-icons PRIVATE "/NOENTRY" "/MANIFEST:NO")
	SET_PROPERTY(TARGET material-design-icons PROPERTY DEBUG_POSTFIX "")
ENDIF()

IF(MINGW)
	TARGET_LINK_OPTIONS(material-design-icons PRIVATE
		-nostartfiles
		-nodefaultlibs
		-nolibc
		-nostdlib
		-s
	)
	SET_PROPERTY(TARGET material-design-icons PROPERTY PREFIX "")
	SET_PROPERTY(TARGET material-design-icons PROPERTY IMPORT_PREFIX "")
ENDIF()

ADD_DEPENDENCIES(wxImg2PdfGui material-design-icons)

ADD_CUSTOM_COMMAND(TARGET material-design-icons POST_BUILD
	COMMAND ${CMAKE_COMMAND} -E copy_if_different $<TARGET_FILE:material-design-icons> $<TARGET_FILE_DIR:wxImg2PdfGui>
)

INSTALL(
	TARGETS material-design-icons
	DESTINATION img2pdf
	COMPONENT img2pdf
)
